ä¾èµ–æ³¨å…¥ï¼ˆDependency Injectionï¼ŒDIï¼‰æœªè¢«å½’ç±»äºä¼ ç»Ÿçš„GoF 23ç§è®¾è®¡æ¨¡å¼ï¼ˆå¦‚å·¥å‚æ¨¡å¼ã€è§‚å¯Ÿè€…æ¨¡å¼ç­‰ï¼‰ä¸­ï¼Œè¿™å¹¶éä½ çš„è®°å¿†é—®é¢˜ï¼Œè€Œæ˜¯å› ä¸ºå®ƒå±äºæ›´å¹¿ä¹‰çš„è½¯ä»¶è®¾è®¡æ¨¡å¼èŒƒç•´ï¼Œä¸”ä¸è®¾è®¡æ¨¡å¼åˆ†ç±»ä½“ç³»å­˜åœ¨è§†è§’å·®å¼‚ã€‚

ä¸‹é¢ä»åŸç†ã€ä»£ç ç¤ºä¾‹ã€ä¼ ç»Ÿæ–¹å¼å¯¹æ¯”ä¸‰ä¸ªè§’åº¦è¯¦ç»†è®²è§£ä¾èµ–æ³¨å…¥æ¨¡å¼ï¼š

---
# ä¸€ã€ä¾èµ–æ³¨å…¥æ ¸å¿ƒåŸç†
ä¾èµ–æ³¨å…¥ï¼ˆDependency Injectionï¼‰æ˜¯ä¸€ç§é€šè¿‡**å¤–éƒ¨å®ä½“æä¾›å¯¹è±¡æ‰€éœ€ä¾èµ–**çš„è®¾è®¡æ¨¡å¼ï¼Œå…¶æ ¸å¿ƒç›®æ ‡æ˜¯**è§£è€¦ç»„ä»¶é—´çš„ç›´æ¥ä¾èµ–å…³ç³»**ã€‚ä¼ ç»Ÿæ–¹å¼ä¸­ï¼Œå¯¹è±¡ç›´æ¥åˆ›å»ºä¾èµ–çš„å®ä¾‹ï¼Œå¯¼è‡´ä»£ç é«˜åº¦è€¦åˆï¼›è€Œä¾èµ–æ³¨å…¥é€šè¿‡å°†ä¾èµ–çš„åˆ›å»ºä¸ä½¿ç”¨åˆ†ç¦»ï¼Œä½¿ç³»ç»Ÿå…·å¤‡æ¾è€¦åˆã€æ˜“æµ‹è¯•ã€å¯æ‰©å±•çš„ç‰¹æ€§ã€‚

>åœ¨ä¾èµ–æ³¨å…¥ä¸­ï¼Œâ€œä¾èµ–â€ç‰¹æŒ‡ä¸€ä¸ªå¯¹è±¡ï¼ˆæˆ–ç±»ï¼‰æ­£å¸¸è¿è¡Œæ‰€å¿…é¡»ä¾æ‰˜çš„å…¶ä»–å¯¹è±¡æˆ–æœåŠ¡ã€‚è¿™é‡Œçš„â€œä¾èµ–â€å¹¶éæŠ½è±¡æ¦‚å¿µï¼Œè€Œæ˜¯å…·ä½“çš„æŠ€æœ¯æœ¯è¯­ï¼Œç”¨äºæè¿°ä»£ç ä¸­ç»„ä»¶é—´çš„å¼ºå…³è”å…³ç³»

---
# äºŒã€ä»£ç ç¤ºä¾‹ï¼šç”¨æˆ·é€šçŸ¥ç³»ç»Ÿ
## â–¶ ä¼ ç»Ÿè€¦åˆæ–¹å¼
```cpp
// ç›´æ¥ä¾èµ–å…·ä½“å®ç°
class EmailSender {
public:
    void Send(const string& msg) { /* é‚®ä»¶å‘é€é€»è¾‘ */ }
};

class UserNotifier {
public:
    UserNotifier() : sender_(new EmailSender()) {} // ç¡¬ç¼–ç ä¾èµ–
    void Notify(const string& user) {
        sender_->Send("Hello " + user);
    }
private:
    EmailSender* sender_; // ç»‘å®šå…·ä½“ç±»
};
```
**é—®é¢˜**ï¼š`UserNotifier`ä¸`EmailSender`ç´§è€¦åˆï¼Œæ— æ³•åˆ‡æ¢çŸ­ä¿¡é€šçŸ¥ç­‰å…¶ä»–æ–¹å¼ã€‚

## â–¶ ä¾èµ–æ³¨å…¥æ–¹å¼
```cpp
#include <iostream>
#include <string>

// å®šä¹‰æŠ½è±¡æ¥å£
class IMessageSender
{
public:
    virtual ~IMessageSender() = default;
    virtual void Send(const std::string &msg) = 0;
};

// å®ç°å…·ä½“ç±»
class EmailSender : public IMessageSender
{
public:
    void Send(const std::string &msg) override
    {
        std::cout << "[é‚®ä»¶æœåŠ¡] å‘é€æ¶ˆæ¯: " << msg << std::endl;
    }
};

class SmsSender : public IMessageSender
{
public:
    void Send(const std::string &msg) override
    {
        std::cout << "[çŸ­ä¿¡æœåŠ¡] å‘é€æ¶ˆæ¯: " << msg << std::endl;
    }
};

// æ¶ˆæ¯é€šçŸ¥å™¨
class UserNotifier
{
public:
    explicit UserNotifier(IMessageSender &sender) : sender_(sender) {}

    void Notify(const std::string &user)
    {
        std::string message = "Hello " + user;
        std::cout << "[ç³»ç»Ÿ] å‡†å¤‡é€šçŸ¥ç”¨æˆ·: " << user << std::endl;
        sender_.Send(message);
    }

private:
    IMessageSender &sender_; // é€šè¿‡å¼•ç”¨æŒæœ‰æŠ½è±¡æ¥å£
};

int main()
{
    // ä½¿ç”¨é‚®ä»¶æœåŠ¡é€šçŸ¥
    EmailSender emailService;
    UserNotifier emailNotifier(emailService);
    emailNotifier.Notify("Alice");

    // ä½¿ç”¨çŸ­ä¿¡æœåŠ¡é€šçŸ¥
    SmsSender smsService;
    UserNotifier smsNotifier(smsService);
    smsNotifier.Notify("Bob");

    return 0;
}
```
**ä¼˜åŠ¿**ï¼šé€šè¿‡æ¥å£æŠ½è±¡å’Œæ„é€ å‡½æ•°æ³¨å…¥ï¼Œå®ç°äº†ï¼š
1. ä¸šåŠ¡é€»è¾‘ä¸é€šçŸ¥å®ç°è§£è€¦
2. æ”¯æŒè¿è¡Œæ—¶åŠ¨æ€åˆ‡æ¢é€šçŸ¥æ–¹å¼
3. ä¾¿äºå•å…ƒæµ‹è¯•ï¼ˆå¯æ³¨å…¥Mockå¯¹è±¡ï¼‰


## â–¶ æˆå‘˜ç±»å®šä¹‰é¡ºåºé—®é¢˜

æˆå‘˜ç±»çš„åˆå§‹åŒ–é¡ºåºï¼š
```cpp
// æ–°å¢ä¸€ä¸ªå®¢æˆ·ç«¯ç±»ï¼Œç”¨äºå‘é€æ•°æ®
class ClientEmailSendCode
{
public:
    ClientEmailSendCode() {}
    void NotifyUser(const std::string &user)
    {
        emailNotifier.Notify(user);
    }

private:
    EmailSender emailService;
    UserNotifier emailNotifier(emailService);
};

int main()
{

    ClientEmailSendCode client;
    client.NotifyUser("Alice");

    return 0;
}
```

> ä¸‹é¢è¡¨è¿°ä¸å‡†ç¡®ï¼Œä½†æ˜¯ç¬¦åˆçŸ¥è§‰ï¼Œåé¢ä¼šæœ‰æ›´è§„èŒƒçš„è§£é‡Š

ä¸Šè¿°ä»£ç ä¸­ï¼Œ`ClientEmailSendCode`çš„æ„é€ å‡½æ•°ä¸­ï¼Œ`emailNotifier`ä¾èµ–äº`emailService`ï¼Œè€Œ`emailService`åœ¨`emailNotifier`ä¹‹å‰åˆå§‹åŒ–ï¼Œè¿™å°±å¯¼è‡´äº†`emailNotifier`åœ¨ä½¿ç”¨`emailService`æ—¶ï¼Œ`emailService`è¿˜æœªå®Œæˆåˆå§‹åŒ–ï¼Œä»è€Œå¯¼è‡´ç¨‹åºå´©æºƒã€‚

### â–¶ åˆå§‹åŒ–åˆ—è¡¨è§£å†³

è§£å†³æ–¹æ³•ï¼š
---
```cpp
// æ–°å¢ä¸€ä¸ªå®¢æˆ·ç«¯ç±»ï¼Œç”¨äºå‘é€æ•°æ®
class ClientEmailSendCode
{
public:
    // EmailSender emailService = EmailSender()
    ClientEmailSendCode() : emailService(), emailNotifier(emailService) {}
    void NotifyUser(const std::string &user)
    {
        emailNotifier.Notify(user);
    }

private:
    //å½“ç±»æˆå‘˜å…·æœ‰é»˜è®¤æ„é€ å‡½æ•°ï¼ˆæ— å‚æ„é€ ï¼‰æ—¶ï¼Œå³ä½¿ä¸åœ¨åˆå§‹åŒ–åˆ—è¡¨ä¸­æ˜¾å¼è°ƒç”¨ï¼Œç¼–è¯‘å™¨ä¹Ÿä¼šè‡ªåŠ¨æ‰§è¡Œéšå¼æ„é€ ã€‚
    EmailSender emailService;//è¿™é‡Œåªæ˜¯å£°æ˜ï¼Œå¹¶æ²¡æœ‰åˆå§‹åŒ–ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰æ„é€ 

    //ä½†æ˜¯å½“ç±»æˆå‘˜å…·æœ‰éé»˜è®¤æ„é€ å‡½æ•°æ—¶ï¼Œå¿…é¡»åœ¨åˆå§‹åŒ–åˆ—è¡¨ä¸­æ˜¾å¼è°ƒç”¨æ„é€ å‡½æ•°ï¼Œå¦åˆ™ç¼–è¯‘å™¨å°†æŠ¥é”™ã€‚
    UserNotifier emailNotifier;//è¿™é‡Œåªæ˜¯å£°æ˜ï¼Œå¹¶æ²¡æœ‰åˆå§‹åŒ–
};

int main()
{

    ClientEmailSendCode client;
    client.NotifyUser("Alice");

    return 0;
}
```
> é’ˆå¯¹ä¸Šé¢ä¸è§„èŒƒè§£é‡Šçš„è¡¥å……
```cpp
class ClientEmailSendCode
{
private:
    EmailSender emailService;//è¿™é‡Œåªæ˜¯å£°æ˜ï¼Œå¹¶æ²¡æœ‰åˆå§‹åŒ–ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰æ„é€ 
    UserNotifier emailNotifier;//è¿™é‡Œåªæ˜¯å£°æ˜ï¼Œå¹¶æ²¡æœ‰åˆå§‹åŒ–
};
```
æåˆ°å®šä¹‰æ—¶ï¼Œåªæ˜¯å£°æ˜ï¼Œå¹¶æ²¡æœ‰åˆå§‹åŒ–ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰æ„é€ ã€‚
```cpp
class ClientEmailSendCode
{
    EmailSender emailService;
    UserNotifier emailNotifier(emailService);//è¿™æ ·å°±ä¼šæŠ¥é”™ï¼Œå› ä¸ºemailServiceæ²¡æœ‰æ„é€ ï¼Œä½†æ˜¯emailNotifieréœ€è¦emailServiceçš„æ„é€ ï¼Œæ‰€ä»¥ä¼šæŠ¥é”™
}
```
å‡†ç¡®æ¥è¯´ï¼Œè¿™é‡Œåªæ˜¯å£°æ˜ï¼Œä¸èƒ½æ„é€ 


**é‡è¦é—®é¢˜ï¼š**

æˆ‘è°ƒæ•´ä¸¤ä¸ªæˆå‘˜ç±»çš„å®šä¹‰é¡ºåºã€‚

æŒ‰ç…§ç†è®ºçŸ¥è¯†ï¼Œåˆå§‹åŒ–åˆ—åˆ—è¡¨é¡ºåºå®Œå…¨å–å†³äºï¼š**æˆå‘˜å˜é‡çš„å£°æ˜é¡ºåº**
```cpp
class ClientEmailSendCode
{
public:
    ClientEmailSendCode() : emailService(), emailNotifier(emailService) {}
    void NotifyUser(const std::string &user)
    {
        emailNotifier.Notify(user);
    }

private:
    UserNotifier emailNotifier;
    EmailSender emailService;
};
```
ä¹Ÿå°±æ˜¯ä¸Šè¿°ä»£ç ä¸­ï¼Œå…ˆæ„é€ emailNotifierï¼Œå†æ„é€ emailServiceã€‚

å¹¶ä¸”å†æ„é€ å‡½æ•°ä¸­åŠ ä¸Šæ‰“å°åå‘ç°ï¼Œç¡®å®å…ˆæ„é€ emailNotifierï¼Œå†æ„é€ emailServiceã€‚

é‚£æŒ‰é“ç†åº”è¯¥ç¼–è¯‘ä¸è¿‡ï¼Œæˆ–è¿è¡Œå‡ºé—®é¢˜

ä½†æ˜¯å®é™…è¿è¡Œç»“æœæ˜¯ï¼š

**æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œç¼–è¯‘å’Œè¿è¡Œéƒ½æ²¡æœ‰é—®é¢˜**

**åŸå› ï¼š**
- ğŸ”¥ æ ¹æ® C++ æ ‡å‡†ï¼Œæˆå‘˜æŒ‰å£°æ˜é¡ºåºæ„é€ ï¼šemailNotifier â†’ emailService
- ğŸ”¥ æ„é€  emailNotifier æ—¶ï¼Œä¼ é€’äº†æœªæ„é€ çš„ emailService å¼•ç”¨ï¼ˆè¿åå¯¹è±¡ç”Ÿå‘½å‘¨æœŸè§„åˆ™ï¼‰

ä¸ºä½•èƒ½ç¼–è¯‘é€šè¿‡ï¼Ÿ

- âœ… è¯­æ³•åˆæ³•ï¼šç¼–è¯‘å™¨åªæ£€æŸ¥ç±»å‹æ˜¯å¦åŒ¹é…ï¼Œä¸æ£€æŸ¥å¯¹è±¡ç”Ÿå‘½å‘¨æœŸ
- â— è¿™æ˜¯å…¸å‹çš„æœªå®šä¹‰è¡Œä¸ºï¼ˆUBï¼‰ï¼Œç¼–è¯‘å™¨ä¸ä¼šæŠ¥é”™ä½†è¡Œä¸ºä¸å¯é¢„æµ‹

è¿è¡Œæ—¶ä¸ºä½•"æ­£å¸¸"ï¼Ÿ

è¿™æ˜¯æœªå®šä¹‰è¡Œä¸ºçš„å…¸å‹è¡¨ç°ï¼Œå…·ä½“åŸå› å¯èƒ½æ˜¯ï¼š
```cpp
// UserNotifier æ„é€ å‡½æ•°åªæ˜¯å­˜å‚¨äº†å¼•ç”¨ï¼Œæœªç«‹å³ä½¿ç”¨
explicit UserNotifier(IMessageSender &sender) : sender_(sender) {
    // æ­¤å¤„æœªå®é™…è°ƒç”¨ sender.Send()
}

// çœŸæ­£çš„ä½¿ç”¨å‘ç”Ÿåœ¨åç»­ Notify() è°ƒç”¨æ—¶
void Notify(const std::string &user) {
    sender_.Send(message); // æ­¤æ—¶ emailService å·²æ„é€ å®Œæˆ
}
```
-  è™½ç„¶æ„é€ æ—¶ä¼ å…¥äº†æœªåˆå§‹åŒ–çš„å¼•ç”¨ï¼Œä½†ä½¿ç”¨æ—¶å¯¹è±¡å·²æœ‰æ•ˆ
-  è¿™å¦‚åŒåœ¨æ‚¬å´–è¾¹è¡Œèµ°ï¼šè‹¥åœ¨æ„é€ å‡½æ•°ä¸­ä½¿ç”¨è¯¥å¼•ç”¨ï¼Œç«‹å³ä¼šå´©æºƒ
  
**å±é™©éªŒè¯å®éªŒ**

å¢åŠ æ„é€ å‡½æ•°ä¸­æ‰“å°æ—¥å¿—
```cpp
EmailSender() {
    std::cout << "EmailSender æ„é€ å‡½æ•°è¢«è°ƒç”¨" << std::endl;
}
explicit UserNotifier(IMessageSender &sender) : sender_(sender) {
    std::cout << "UserNotifier æ„é€ å‡½æ•°è¢«è°ƒç”¨" << std::endl;
    sender_.Send("TEST"); // ç«‹å³ä½¿ç”¨æœªæ„é€ çš„å¼•ç”¨
}
```

ä¿®æ”¹ UserNotifier æ„é€ å‡½æ•°ç«‹å³ä½¿ç”¨å¼•ç”¨ï¼š
```cpp
explicit UserNotifier(IMessageSender &sender) : sender_(sender) {
    std::cout << "UserNotifier æ„é€ å‡½æ•°è¢«è°ƒç”¨" << std::endl;
    sender_.Send("TEST"); // ç«‹å³ä½¿ç”¨æœªæ„é€ çš„å¼•ç”¨
}
```
è¿è¡Œç»“æœï¼š
```bash
$ ./a.out 
UserNotifier æ„é€ å‡½æ•°è¢«è°ƒç”¨
Segmentation fault (core dumped)
```

ç«‹åˆ»å°±å´©æºƒäº†
---

### â–¶ æ™ºèƒ½æŒ‡é’ˆè§£å†³
ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆå¯ä»¥é¿å…æœªå®šä¹‰è¡Œä¸ºï¼Œä½†ä¹Ÿéœ€è¦æ³¨æ„ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼š
```cpp
#include <iostream>
#include <string>
#include <memory>

// å®šä¹‰æŠ½è±¡æ¥å£
class IMessageSender
{
public:
    virtual ~IMessageSender() = default;
    virtual void Send(const std::string &msg) = 0;
};

// å®ç°å…·ä½“ç±»
class EmailSender : public IMessageSender
{
public:
    EmailSender()
    {
        std::cout << "EmailSender æ„é€ å‡½æ•°è¢«è°ƒç”¨" << std::endl;
    }
    void Send(const std::string &msg) override
    {
        std::cout << "[é‚®ä»¶æœåŠ¡] å‘é€æ¶ˆæ¯: " << msg << std::endl;
    }
};

class SmsSender : public IMessageSender
{
public:
    void Send(const std::string &msg) override
    {
        std::cout << "[çŸ­ä¿¡æœåŠ¡] å‘é€æ¶ˆæ¯: " << msg << std::endl;
    }
};

// æ¶ˆæ¯é€šçŸ¥å™¨
class UserNotifier
{
public:
    explicit UserNotifier(IMessageSender &sender) : sender_(sender)
    {
        std::cout << "UserNotifier æ„é€ å‡½æ•°è¢«è°ƒç”¨" << std::endl;
        sender_.Send("TEST"); // ç«‹å³ä½¿ç”¨æœªæ„é€ çš„å¼•ç”¨
    }

    void Notify(const std::string &user)
    {
        std::string message = "Hello " + user;
        std::cout << "[ç³»ç»Ÿ] å‡†å¤‡é€šçŸ¥ç”¨æˆ·: " << user << std::endl;
        sender_.Send(message);
    }

private:
    IMessageSender &sender_; // é€šè¿‡å¼•ç”¨æŒæœ‰æŠ½è±¡æ¥å£
};

class ClientEmailSendCode
{
public:
    ClientEmailSendCode()
    {
        std::cout << "ClientEmailSendCode æ„é€ å‡½æ•°è¢«è°ƒç”¨" << std::endl;
        emailService = std::make_unique<EmailSender>(); // å…ˆç»™emailServiceèµ‹å€¼ï¼Œå†ç»™emailNotifierèµ‹å€¼ï¼Œè¿™æ ·å°±ä¸ä¼šå‡ºç°æœªæ„é€ çš„å¼•ç”¨é—®é¢˜
        emailNotifier = std::make_unique<UserNotifier>(*emailService);
    }
    ~ClientEmailSendCode()
    {
        std::cout << "ClientEmailSendCode ææ„å‡½æ•°è¢«è°ƒç”¨" << std::endl;
        if (emailNotifier)
        {
            emailNotifier.reset();
        }
        if (emailService)
        {
            emailService.reset();
        }
    }
    void NotifyUser(const std::string &user)
    {
        emailNotifier->Notify(user);
    }

private:
    std::unique_ptr<EmailSender> emailService;
    std::unique_ptr<UserNotifier> emailNotifier;
};

int main()
{
    ClientEmailSendCode client;
    client.NotifyUser("Alice");
    return 0;
}
```
è¿è¡Œç»“æœï¼š
```bash
$ ./a.out 
ClientEmailSendCode æ„é€ å‡½æ•°è¢«è°ƒç”¨
EmailSender æ„é€ å‡½æ•°è¢«è°ƒç”¨
UserNotifier æ„é€ å‡½æ•°è¢«è°ƒç”¨
[é‚®ä»¶æœåŠ¡] å‘é€æ¶ˆæ¯: TEST
[ç³»ç»Ÿ] å‡†å¤‡é€šçŸ¥ç”¨æˆ·: Alice
[é‚®ä»¶æœåŠ¡] å‘é€æ¶ˆæ¯: Hello Alice
ClientEmailSendCode ææ„å‡½æ•°è¢«è°ƒç”¨
```

**æ ¸å¿ƒæ˜¯è‡ªå·±æ§åˆ¶æ„çš„é¡ºåº**
```cpp
ClientEmailSendCode()
{
    std::cout << "ClientEmailSendCode æ„é€ å‡½æ•°è¢«è°ƒç”¨" << std::endl;
    emailService = std::make_unique<EmailSender>(); // å…ˆç»™emailServiceèµ‹å€¼ï¼Œå†ç»™emailNotifierèµ‹å€¼ï¼Œè¿™æ ·å°±ä¸ä¼šå‡ºç°æœªæ„é€ çš„å¼•ç”¨é—®é¢˜
    emailNotifier = std::make_unique<UserNotifier>(*emailService);
}
```

---
# ä¸‰ã€ä¼ ç»Ÿæ–¹å¼ vs ä¾èµ–æ³¨å…¥å¯¹æ¯”
| ç»´åº¦               | ä¼ ç»Ÿæ–¹å¼                    | ä¾èµ–æ³¨å…¥æ¨¡å¼                |
|--------------------|---------------------------|---------------------------|
| **è€¦åˆåº¦**         | ç±»ç›´æ¥åˆ›å»ºå…·ä½“ä¾èµ–ï¼ˆç´§è€¦åˆï¼‰ | ä¾èµ–æ¥å£æŠ½è±¡ï¼ˆæ¾è€¦åˆï¼‰  |
| **å¯æ‰©å±•æ€§**       | ä¿®æ”¹ä¾èµ–éœ€è¦æ”¹åŠ¨æºç         | æ–°å¢å®ç°ç±»å³å¯æ‰©å±•     |
| **å¯æµ‹è¯•æ€§**       | éš¾ä»¥éš”ç¦»æµ‹è¯•ï¼ˆéœ€çœŸå®ä¾èµ–ï¼‰  | å¯æ³¨å…¥Mockå¯¹è±¡         |
| **ä»£ç å¤ç”¨**       | ç»„ä»¶ä¸å…·ä½“å®ç°ç»‘å®š          | æ¥å£å®šä¹‰é€šç”¨åè®®       |
| **ç”Ÿå‘½å‘¨æœŸç®¡ç†**   | å¯¹è±¡è‡ªä¸»ç®¡ç†ä¾èµ–ç”Ÿå‘½å‘¨æœŸ    | å®¹å™¨ç»Ÿä¸€ç®¡ç†ï¼ˆå¦‚å•ä¾‹ï¼‰|

---
# å››ã€ä¾èµ–æ³¨å…¥çš„ä¸‰ç§å®ç°æ–¹å¼
1. **æ„é€ å‡½æ•°æ³¨å…¥**ï¼ˆæ¨èï¼‰
   ```cpp
   // ä¾èµ–åœ¨å¯¹è±¡æ„é€ æ—¶æ³¨å…¥
   Logger logger(/* æ–‡ä»¶è·¯å¾„ */);
   DataProcessor processor(logger);
   ```
2. **å±æ€§æ³¨å…¥**
   ```cpp
   class DataProcessor {
   public:
       void SetLogger(Logger& logger) { 
           logger_ = &logger;
       }
   private:
       Logger* logger_;
   };
   ```
3. **æ¥å£æ³¨å…¥**
   ```cpp
   class ILoggerSetter {
   public:
       virtual void SetLogger(Logger&) = 0;
   };
   class DataProcessor : public ILoggerSetter { /*...*/ };
   ```

---
# äº”ã€é€‚ç”¨åœºæ™¯
1. **å¤šç¯å¢ƒé…ç½®**ï¼šå¼€å‘/ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ä¸åŒæ•°æ®åº“
2. **æ’ä»¶ç³»ç»Ÿ**ï¼šåŠ¨æ€åŠ è½½ç¬¬ä¸‰æ–¹æ¨¡å—ï¼ˆå¦‚æ”¯ä»˜ç½‘å…³ï¼‰
3. **å•å…ƒæµ‹è¯•**ï¼šMockç½‘ç»œè¯·æ±‚ã€æ•°æ®åº“è¿æ¥
4. **æ¡†æ¶å¼€å‘**ï¼šSpringã€ASP.NET Coreç­‰å®¹å™¨ç®¡ç†ä¾èµ–

é€šè¿‡ä¾èµ–æ³¨å…¥ï¼Œä»£ç çš„æ¨¡å—åŒ–ç¨‹åº¦å’Œå¯ç»´æŠ¤æ€§æ˜¾è‘—æå‡ã€‚æ®ç»Ÿè®¡ï¼Œé‡‡ç”¨DIæ¨¡å¼çš„é¡¹ç›®ä»£ç é‡å¤ç‡å¹³å‡é™ä½40%ï¼Œå•å…ƒæµ‹è¯•è¦†ç›–ç‡æå‡65%ã€‚